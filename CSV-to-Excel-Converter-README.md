# CSV to Excel Converter for Windows Autorun Analyzer

This tool converts CSV files generated by the Windows Autorun Analyzer back to properly formatted Excel files with color coding and analysis summary.

## Features

✅ **Color Coding** - RED/YELLOW/WHITE status colors applied to entire rows  
✅ **Analysis Summary** - Interactive tables with statistics and breakdowns  
✅ **Batch Processing** - Convert multiple CSV files at once  
✅ **Recursive Processing** - Process all CSV files in subdirectories  
✅ **Auto-Installation** - Automatically installs ImportExcel module if needed  
✅ **Error Handling** - Robust error handling and status reporting  

## Files Included

- `Convert-CSV-to-Excel.ps1` - Main PowerShell script
- `convert_csv_to_excel.bat` - Windows batch file wrapper
- `CSV-to-Excel-Converter-README.md` - This documentation

## Usage

### Method 1: PowerShell Script (Recommended)

```powershell
# Convert single CSV file
.\Convert-CSV-to-Excel.ps1 -CsvPath "AutorunAnalysis_20250113_140657.csv"

# Convert with custom output path
.\Convert-CSV-to-Excel.ps1 -CsvPath "AutorunAnalysis_20250113_140657.csv" -OutputPath "C:\Reports\Analysis.xlsx"

# Convert all CSV files in directory
.\Convert-CSV-to-Excel.ps1 -CsvPath "C:\temp" -Recursive

# Show help
.\Convert-CSV-to-Excel.ps1 -Help
```

### Method 2: Batch File (Easy)

```cmd
# Convert single CSV file
convert_csv_to_excel.bat "AutorunAnalysis_20250113_140657.csv"

# Convert all CSV files in directory
convert_csv_to_excel.bat "C:\temp"

# Convert recursively
convert_csv_to_excel.bat "C:\temp" -Recursive
```

## Parameters

| Parameter | Description | Required | Example |
|-----------|-------------|----------|---------|
| `-CsvPath` | Path to CSV file or directory containing CSV files | Yes | `"C:\temp\file.csv"` |
| `-OutputPath` | Custom output path for Excel file | No | `"C:\Reports\Analysis.xlsx"` |
| `-Recursive` | Process all CSV files in subdirectories | No | Switch |
| `-Help` | Show help message | No | Switch |

## Output Format

The converted Excel files will have:

### Main Data Sheet
- **Status column in Column A** - Color-coded RED/YELLOW/WHITE
- **Full row color coding** - Entire rows colored based on status
- **All original columns** - User, Type, Location, Name, Command, Publisher, etc.
- **Proper formatting** - Auto-sized columns and table styling

### Analysis Summary Sheet
- **Total counts** - Items by status (RED/YELLOW/WHITE)
- **Status breakdown** - Count and percentage by status
- **Type breakdown** - Count and percentage by autorun type
- **User breakdown** - Count and percentage by user
- **Publisher analysis** - Top 15 publishers with counts and percentages

## Color Coding

| Status | Color | Description |
|--------|-------|-------------|
| **RED** | Light Red | Suspicious items requiring investigation |
| **YELLOW** | Light Yellow | After-market/third-party software |
| **WHITE** | White | Baseline Windows items |

## Examples

### Convert Single File
```powershell
.\Convert-CSV-to-Excel.ps1 -CsvPath "AutorunAnalysis_20250113_140657.csv"
```
**Output:** `AutorunAnalysis_20250113_140657.xlsx`

### Convert with Custom Output
```powershell
.\Convert-CSV-to-Excel.ps1 -CsvPath "AutorunAnalysis_20250113_140657.csv" -OutputPath "C:\Reports\Security_Analysis.xlsx"
```
**Output:** `C:\Reports\Security_Analysis.xlsx`

### Batch Convert Directory
```powershell
.\Convert-CSV-to-Excel.ps1 -CsvPath "C:\temp" -Recursive
```
**Output:** All CSV files in `C:\temp` and subdirectories converted to Excel

### Using Batch File
```cmd
convert_csv_to_excel.bat "C:\temp\AutorunAnalysis_20250113_140657.csv"
```

## Requirements

- **PowerShell 5.1 or later**
- **Windows 10/11 or Windows Server 2016+**
- **ImportExcel module** (automatically installed if missing)
- **Excel COM object** (for color coding and analysis summary)

## Installation

1. Download the script files to your desired location
2. No installation required - just run the script
3. The script will automatically install the ImportExcel module if needed

## Troubleshooting

### ImportExcel Module Issues
If you get ImportExcel module errors:
```powershell
Install-Module ImportExcel -Force -Scope CurrentUser
```

### Execution Policy Issues
If you get execution policy errors:
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### Excel COM Object Issues
If color coding fails:
- Ensure Excel is installed on the system
- Check that no Excel processes are running
- The script will still create a basic Excel file without color coding

## Output Examples

### Successful Conversion
```
[14:06:57] CSV to Excel Converter for Windows Autorun Analyzer
[14:06:57] ===================================================
[14:06:57] Converting: AutorunAnalysis_20250113_140657.csv
[14:06:57] Found 150 records
[14:06:57] Basic Excel file created: AutorunAnalysis_20250113_140657.xlsx
[14:06:57] Adding color coding...
[14:06:58] Creating analysis summary...
[14:06:58] Analysis summary created successfully
[14:06:58] Excel file with color coding created successfully: AutorunAnalysis_20250113_140657.xlsx
[14:06:58] Conversion Summary:
[14:06:58] ==================
[14:06:58] Files processed: 1
[14:06:58] Successful conversions: 1
[14:06:58] Failed conversions: 0
[14:06:58] Conversion completed successfully!
```

## Integration with Windows Autorun Analyzer

This converter is designed to work with CSV files generated by:
- `WindowsAutorunAnalyzer.ps1`
- `WindowsAutorunAnalyzer_Universal.ps1`
- `WindowsAutorunAnalyzer_Portable.ps1`

The converter will restore the intended Excel formatting that may have been lost when the original script fell back to CSV output.

## Support

For issues or questions:
1. Check the error messages in the console output
2. Ensure all requirements are met
3. Try running with `-Help` parameter for usage information
4. Verify the CSV file format matches the expected Windows Autorun Analyzer output
